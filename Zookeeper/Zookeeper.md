# Zookeeper

## Zookeeper基础

这是一个开源分布式的、为分布式框架协调服务的Apache项目。

从设计模式上讲，这是一个基于观察者模式设计的分布式服务框架，负责 **存储和管理被关注的数据** 并且 **接受观察者的注册**，一旦这些数据改变，Zookeeper就需要负责通知Zookeeper上**注册过的观察者** 并且执行相应的操作。

==Zookeeper = 文件系统 + 通知机制==

### Zookeeper的特点

1. 存在**一个Leader**和多个Follower组成的集群
2. 集群中只要有**半数以上**节点存活，即可提供正常服务（适合在奇数台服务器上运行）
3. **全局数据一致**，每个Server保存相同的一份数据副本，Client连接哪个服务器都一样
4. 更新请求**顺序执行**，来自同一个Client的更新请求是按发送顺序执行的
5. 数据**更新原子性**，全部成功或全部失败
6. **实时性**，在一定时间内，Client就可以拿到最新的数据

### Zookeeper数据结构

和Linux很类似，可以看作是**树形结构**的存储结构，每个节点叫做**ZNode**，每个节点默认存储1MB数据。Znode可以根据树的路径被**唯一标识**。

### 应用场景

1. 统一命名服务：对应用和服务进行统一命名，如域名和IP的一对多。
2. 统一配置管理：讲配置信息写入Zookeeper的一个ZNode，使得各个客户端服务器监听这个ZNode来读取配置信息。
	- 要求节点的配置信息一致，如Kafka集群
	- 修改配置文件后，快速同步到各个节点
3. 统一集群管理：Zookeeper可以监控节点的状态变化，即讲节点的信息写入一个ZNode，监听这个ZNode的变化即可。
	- 集群中需要掌握每个节点的状态，并且根据节点信息进行调整
4. 服务器动态上下线：监控服务器是否在线，并实现注册和监听等功能
5. 软负载均衡：在Zookeeper中记录每台服务器的访问数，让访问最少的服务器处理最新的请求

